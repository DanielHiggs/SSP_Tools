classdef RK8 < SSP_Tools.Integrators.RK
	methods
		function obj = RK8(varargin)
			obj = obj@SSP_Tools.Integrators.RK(varargin{:});			
			
			name = 'Fehlberg 8th Order Runge-Kutta';
			A = zeros(13, 13);
			
			A(2,1) = 2/27;
			
			A(3,1) = 1/36;
			A(3,2) = 1/12;
			
			A(4,1) = 1/24;
			A(4,3) = 1/8;
			
			A(5,1) = 5/12;
			A(5,3) = -25/16;
			A(5,4) = 25/16;
			
			A(6,1) = 1/20;
			A(6,4) = 1/4;
			A(6,5) = 1/5;
			
			A(7,1) = -25/108;
			A(7,4) = 125/108;
			A(7,5) = -65/27;
			A(7,6) = 125/54;
			
			A(8,1) = 31/300;
			A(8,5) = 61/225;
			A(8,6) = -2/9;
			A(8,7) = 13/900;
			
			A(9,1) = 2;
			A(9,4) = -53/6;
			A(9,5) = 704/45;
			A(9,6) = -107/9;
			A(9,7) = 67/90;
			A(9,8) = 3;
			
			A(10,1) = -91/108;
			A(10,4) = 23/108;
			A(10,5) = -976/135;
			A(10,6) = 311/54;
			A(10,7) = -19/60;
			A(10,8) = 17/6;
			A(10,9) = -1/12;
			
			A(11,1) = 2383/4100;
			A(11,4) = -341/164;
			A(11,5) = 4496/1025;
			A(11,6) = -301/82;
			A(11,7) = 2133/4100;
			A(11,8) = 45/82;
			A(11,9) = 45/164;
			A(11,10) = 18/41;
			
			A(12,1) = 3/205;
			A(12,6) = -6/41;
			A(12,7) = -3/205;
			A(12,8) = -3/41;
			A(12,9) = 3/41;
			A(12,10) = 6/41;
			
			A(13,1) = -1777/4100;
			A(13,4) = -341/164;
			A(13,5) = 4496/1025;
			A(13,6) = -289/82;
			A(13,7) = 2193/4100;
			A(13,8) = 51/82;
			A(13,9) = 33/164;
			A(13,10) = 12/41;
			A(13,12) = 1;
			
			obj.alpha = A;
			obj.c = [0, 2/27, 1/9, 1/6, 5/12, 1/2, 5/6, 1/6, 2/3, 1/3, 1, 0, 1];
			
			% These coefficients provide the 7th order embedded method.
			%b7 = [41/840, 0, 0, 0, 0, 34/105, 9/35,  9/35, 9/280, 9/280, 41/840, 0,0];
			
			obj.b = [ 0, 0, 0, 0, 0, 34/105, 9/35, 9/35, 9/280, 9/280, 0, 41/840, 41/840 ];
			
		end

		function parameters = get_parameters(obj)
			
			parameters = [];
			
		end
		
	end
end